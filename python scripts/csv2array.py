import csv
import json
from fuzzywuzzy import fuzz
from fuzzywuzzy import process

data = []

with open('playerdata2.csv') as f:
    cr=csv.reader(f)
    skip=next(cr)  #skip the first row of keys "a,b,c,d"
    data =  [map(str, l) for l in cr]

leagueTables = [["1", "Premier League", "Chelsea", "38", "30", "3", "5", "85", "33", "52", "93", "394", "72", "0", "580", "204"], ["2", "Premier League", "Tottenham", "38", "26", "8", "4", "86", "26", "60", "86", "432", "62", "0", "669", "257"], ["3", "Premier League", "Man City", "38", "23", "9", "6", "80", "39", "41", "78", "395", "71", "4", "633", "217"], ["4", "Premier League", "Liverpool", "38", "22", "10", "6", "78", "42", "36", "76", "397", "54", "0", "638", "236"], ["5", "Premier League", "Arsenal", "38", "23", "6", "9", "77", "44", "33", "75", "397", "67", "3", "565", "200"], ["6", "Premier League", "Man United", "38", "18", "15", "5", "54", "29", "25", "69", "497", "76", "2", "589", "210"], ["7", "Premier League", "Everton", "38", "17", "10", "11", "62", "44", "18", "61", "459", "71", "2", "498", "192"], ["8", "Premier League", "Southampton", "38", "12", "10", "16", "41", "48", "-7", "46", "424", "58", "2", "548", "179"], ["9", "Premier League", "Bournemouth", "38", "12", "10", "16", "55", "67", "-12", "46", "366", "51", "3", "446", "160"], ["10", "Premier League", "West Brom", "38", "12", "9", "17", "43", "51", "-8", "45", "449", "80", "0", "400", "123"], ["11", "Premier League", "West Ham", "38", "12", "9", "17", "47", "64", "-17", "45", "408", "77", "5", "496", "138"], ["12", "Premier League", "Leicester", "38", "12", "8", "18", "48", "63", "-15", "44", "451", "71", "1", "432", "145"], ["13", "Premier League", "Stoke", "38", "11", "11", "16", "41", "56", "-15", "44", "434", "70", "2", "426", "137"], ["14", "Premier League", "Crystal Palace", "38", "12", "5", "21", "50", "63", "-13", "41", "469", "77", "0", "438", "138"], ["15", "Premier League", "Swansea", "38", "12", "5", "21", "45", "70", "-25", "41", "401", "56", "0", "390", "146"], ["16", "Premier League", "Burnley", "38", "11", "7", "20", "39", "55", "-16", "40", "426", "65", "2", "390", "120"], ["17", "Premier League", "Watford", "38", "11", "7", "20", "40", "68", "-28", "40", "517", "83", "5", "419", "144"], ["18", "Premier League", "Hull", "38", "9", "7", "22", "37", "80", "-43", "34", "403", "67", "5", "396", "127"], ["19", "Premier League", "Middlesbrough", "38", "5", "13", "20", "27", "53", "-26", "28", "478", "76", "1", "349", "100"], ["20", "Premier League", "Sunderland", "38", "6", "6", "26", "29", "69", "-40", "24", "437", "76", "4", "387", "121"], ["1", "Serie A", "Juventus", "38", "29", "4", "5", "77", "27", "50", "91", "473", "70", "0", "583", "221"], ["2", "Serie A", "Roma", "38", "28", "3", "7", "90", "38", "52", "87", "462", "64", "1", "676", "234"], ["3", "Serie A", "Napoli", "38", "26", "8", "4", "94", "39", "55", "86", "376", "58", "2", "670", "262"], ["4", "Serie A", "Atalanta", "38", "21", "9", "8", "62", "41", "21", "72", "603", "85", "3", "534", "201"], ["5", "Serie A", "Lazio", "38", "21", "7", "10", "74", "51", "23", "70", "543", "90", "4", "584", "211"], ["6", "Serie A", "Milan", "38", "18", "9", "11", "57", "45", "12", "63", "521", "81", "12", "555", "191"], ["7", "Serie A", "Inter", "38", "19", "5", "14", "72", "49", "23", "62", "540", "74", "5", "630", "208"], ["8", "Serie A", "Fiorentina", "38", "16", "12", "10", "63", "57", "6", "60", "535", "92", "6", "609", "226"], ["9", "Serie A", "Torino", "38", "13", "14", "11", "71", "66", "5", "53", "587", "80", "4", "573", "184"], ["10", "Serie A", "Sampdoria", "38", "12", "12", "14", "49", "55", "-6", "48", "511", "73", "4", "501", "167"], ["11", "Serie A", "Cagliari", "38", "14", "5", "19", "55", "76", "-21", "47", "557", "97", "7", "421", "174"], ["12", "Serie A", "Sassuolo", "38", "13", "7", "18", "58", "63", "-5", "46", "518", "90", "2", "441", "171"], ["13", "Serie A", "Udinese", "38", "12", "9", "17", "47", "56", "-9", "45", "484", "84", "2", "434", "155"], ["14", "Serie A", "Chievo", "38", "12", "7", "19", "43", "61", "-18", "43", "555", "82", "4", "407", "129"], ["15", "Serie A", "Bologna", "38", "11", "8", "19", "40", "58", "-18", "41", "486", "84", "11", "422", "145"], ["16", "Serie A", "Genoa", "38", "9", "9", "20", "38", "64", "-26", "36", "623", "89", "8", "443", "147"], ["17", "Serie A", "Crotone", "38", "9", "7", "22", "34", "58", "-24", "34", "585", "87", "4", "399", "130"], ["18", "Serie A", "Empoli", "38", "8", "8", "22", "29", "61", "-32", "32", "538", "107", "2", "362", "127"], ["19", "Serie A", "Palermo", "38", "6", "8", "24", "33", "77", "-44", "26", "564", "93", "9", "381", "118"], ["20", "Serie A", "Pescara", "38", "3", "9", "26", "37", "81", "-44", "18", "551", "92", "4", "442", "146"], ["1", "La Liga", "Real Madrid", "38", "29", "6", "3", "106", "41", "65", "93", "425", "72", "2", "661", "265"], ["2", "La Liga", "Barcelona", "38", "28", "6", "4", "116", "37", "79", "90", "421", "73", "1", "648", "268"], ["3", "La Liga", "Ath Madrid", "38", "23", "9", "6", "70", "27", "43", "78", "498", "80", "3", "502", "198"], ["4", "La Liga", "Sevilla", "38", "21", "9", "8", "69", "49", "20", "72", "581", "105", "4", "486", "198"], ["5", "La Liga", "Villarreal", "38", "19", "10", "9", "56", "33", "23", "67", "507", "89", "4", "425", "169"], ["6", "La Liga", "Sociedad", "38", "19", "7", "12", "59", "53", "6", "64", "528", "79", "6", "487", "167"], ["7", "La Liga", "Ath Bilbao", "38", "19", "6", "13", "53", "43", "10", "63", "499", "87", "2", "478", "186"], ["8", "La Liga", "Espanol", "38", "15", "11", "12", "49", "50", "-1", "56", "567", "80", "2", "343", "129"], ["9", "La Liga", "Alaves", "38", "14", "13", "11", "41", "43", "-2", "55", "540", "113", "5", "389", "132"], ["10", "La Liga", "Eibar", "38", "15", "9", "14", "56", "51", "5", "54", "515", "91", "7", "449", "177"], ["11", "La Liga", "Malaga", "38", "12", "10", "16", "49", "55", "-6", "46", "547", "108", "7", "491", "168"], ["12", "La Liga", "Valencia", "38", "13", "7", "18", "56", "65", "-9", "46", "550", "108", "6", "447", "169"], ["13", "La Liga", "Celta", "38", "13", "6", "19", "53", "69", "-16", "45", "513", "98", "8", "405", "148"], ["14", "La Liga", "Las Palmas", "38", "10", "9", "19", "53", "74", "-21", "39", "466", "98", "6", "437", "182"], ["15", "La Liga", "Betis", "38", "10", "9", "19", "41", "64", "-23", "39", "574", "102", "5", "440", "152"], ["16", "La Liga", "La Coruna", "38", "8", "12", "18", "43", "61", "-18", "36", "536", "92", "4", "461", "145"], ["17", "La Liga", "Leganes", "38", "8", "11", "19", "36", "55", "-19", "35", "644", "105", "3", "413", "132"], ["18", "La Liga", "Sp Gijon", "38", "7", "10", "21", "42", "72", "-30", "31", "567", "112", "4", "375", "135"], ["19", "La Liga", "Osasuna", "38", "4", "10", "24", "40", "94", "-54", "22", "567", "98", "3", "389", "143"], ["20", "La Liga", "Granada", "38", "4", "8", "26", "30", "82", "-52", "20", "553", "109", "6", "380", "124"], ["1", "Bundesliga", "Bayern Munich", "34", "25", "7", "2", "89", "22", "67", "82", "360", "47", "0", "621", "229"], ["2", "Bundesliga", "RB Leipzig", "34", "20", "7", "7", "66", "39", "27", "67", "523", "66", "2", "442", "173"], ["3", "Bundesliga", "Dortmund", "34", "18", "10", "6", "72", "40", "32", "64", "413", "55", "2", "534", "204"], ["4", "Bundesliga", "Hoffenheim", "34", "16", "14", "4", "64", "37", "27", "62", "514", "63", "1", "498", "181"], ["5", "Bundesliga", "FC Koln", "34", "12", "13", "9", "51", "42", "9", "49", "476", "72", "1", "360", "119"], ["6", "Bundesliga", "Hertha", "34", "15", "4", "15", "43", "47", "-4", "49", "473", "63", "3", "345", "126"], ["7", "Bundesliga", "Freiburg", "34", "14", "6", "14", "42", "60", "-18", "48", "445", "56", "1", "403", "145"], ["8", "Bundesliga", "Werder Bremen", "34", "13", "6", "15", "61", "64", "-3", "45", "476", "67", "2", "377", "154"], ["9", "Bundesliga", "M'gladbach", "34", "12", "9", "13", "45", "49", "-4", "45", "419", "46", "2", "410", "146"], ["10", "Bundesliga", "Schalke 04", "34", "11", "10", "13", "45", "40", "5", "43", "508", "69", "3", "442", "137"], ["11", "Bundesliga", "Ein Frankfurt", "34", "11", "9", "14", "36", "43", "-7", "42", "538", "82", "6", "380", "124"], ["12", "Bundesliga", "Leverkusen", "34", "11", "8", "15", "53", "55", "-2", "41", "478", "50", "4", "445", "177"], ["13", "Bundesliga", "Augsburg", "34", "9", "11", "14", "35", "51", "-16", "38", "494", "66", "3", "370", "127"], ["14", "Bundesliga", "Hamburg", "34", "10", "8", "16", "33", "61", "-28", "38", "564", "73", "5", "359", "113"], ["15", "Bundesliga", "Mainz", "34", "10", "7", "17", "44", "55", "-11", "37", "493", "67", "7", "414", "152"], ["16", "Bundesliga", "Wolfsburg", "34", "10", "7", "17", "34", "52", "-18", "37", "513", "65", "3", "426", "143"], ["17", "Bundesliga", "Ingolstadt", "34", "8", "8", "18", "36", "57", "-21", "32", "554", "69", "6", "457", "162"], ["18", "Bundesliga", "Darmstadt", "34", "7", "4", "23", "28", "63", "-35", "25", "516", "67", "5", "335", "94"]]
mergecount = 0
for i in range(len(leagueTables)):
	for j in range(len(data)):
		if (fuzz.ratio(leagueTables[i][2], data[j][0]) > 68):
			leagueTables[i][2] = data[j][0]
			mergecount = mergecount + 1
			break
		elif (j == len(data) - 1):
			print("NOT SWAPPED: {}").format(leagueTables[i][2])

print mergecount

f = open('newteams.txt', 'w')
json.dump(leagueTables, f)
f.close()